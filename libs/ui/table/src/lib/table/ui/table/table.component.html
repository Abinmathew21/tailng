<div class="relative">
  <table [class]="tableClassFinal()">
    <thead [class]="theadClassFinal()">
      <tr>
        @for (col of columns(); track col.id) {
          <th
            scope="col"
            [class]="(thClassFinal() + ' ' + alignClass(col.align) + (col.headerClass ? ' ' + col.headerClass : '')).trim()"
            [ngStyle]="styleWidth(col)"
          >
            @if (col.headerTpl) {
              <ng-container
                [ngTemplateOutlet]="col.headerTpl"
                [ngTemplateOutletContext]="headerCtx(col)"
              />
            } @else {
              {{ col.header }}
            }
          </th>
        }
      </tr>
    </thead>

    <tbody [class]="tbodyClassFinal()">
      @if (hasRows()) {
        @for (row of viewRows(); let rowIndex = $index; track row?.[rowKey()] ?? rowIndex) {
          <tr>
            @for (col of columns(); track col.id) {
              <td
                [class]="(tdClassFinal() + ' ' + alignClass(col.align) + (col.cellClass ? ' ' + col.cellClass : '')).trim()"
              >
                @if (col.cellTpl) {
                  <ng-container
                    [ngTemplateOutlet]="col.cellTpl"
                    [ngTemplateOutletContext]="cellCtx(row, rowIndex, col)"
                  />
                } @else {
                  {{ col.value?.(row) }}
                }
              </td>
            }
          </tr>
        }
      } @else {
        <tr>
          <td [attr.colspan]="columns().length || 1" class="px-3 py-8 text-center text-disable">
            {{ emptyText() }}
          </td>
        </tr>
      }
    </tbody>
  </table>

  <!-- Render projected extras like filter panel -->
  <ng-content />
</div>
